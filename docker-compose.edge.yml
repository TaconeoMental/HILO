services:
  nginx:
    ports: []
    volumes:
      - ./infra/nginx/conf.d/app.prod.http.conf:/etc/nginx/conf.d/default.conf:ro
      - ./infra/nginx/conf.d/includes:/etc/nginx/conf.d/includes:ro
    networks:
      - edge
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=${EDGE_NETWORK:-edge}"
      - "traefik.http.routers.kiroku-app.rule=Host(`${APP_HOST}`)"
      - "traefik.http.routers.kiroku-app.entrypoints=websecure"
      - "traefik.http.routers.kiroku-app.tls=true"
      - "traefik.http.services.kiroku-app.loadbalancer.server.port=80"

networks:
  edge:
    external: true
    name: "${EDGE_NETWORK_NAME:-edge}"

